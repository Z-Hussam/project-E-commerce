
{% extends 'base.html.twig' %}

{% block title %}Récapitulatif de votre commande{% endblock %}

{% block body %}
    <div class="container my-5 py-3">
        
        <div class="text-center mb-5">
            <h1 class="fw-bolder text-dark">Récapitulatif de votre commande</h1>
            <p class="lead text-muted mx-auto" style="max-width: 600px;">
                Veuillez vérifier les informations ci-dessous avant de procéder au paiement sécurisé.
            </p>
        </div>

        <div class="row g-5">
            
            <div class="col-12 col-lg-8">

                <div class="card mb-4">
                    <div class="card-header bg-dark  text-white fw-bold h5">
                         Contenu de mon panier ({{ cart|length }} articles)
                    </div>
                    <ul class="list-group list-group-flush">
                        {% for product in cart %}
                            <li class="list-group-item p-3">
                                <div class="row align-items-center g-3">
                                    <div class="col-3 col-md-2">
                                        <img src="/uploads/{{product.object.illustration}}" alt="{{product.object.name}}" class="img-fluid rounded-2 border">
                                    </div>
                                    <div class="col-9 col-md-5">
                                        <h6 class="fw-bold mb-0">{{product.object.name}}</h6>
                                        <span class="small text-muted">Prix unitaire: {{product.object.pricewt|price}}</span>
                                    </div>
                                    <div class="col-5 col-md-2 text-md-center">
                                        <span class="text-secondary small">Qté:</span>
                                        <span class="fw-bold text-dark">x{{product.qty}}</span>
                                    </div>
                                    <div class="col-7 col-md-3 text-end">
                                        <strong class="text-secondary fs-6">{{(product.qty * product.object.priceWt)|price}}</strong>
                                    </div>
                                </div>
                            </li>
                        {% endfor %}
                    </ul>
                </div>

                <div class="row g-4">
                    <div class="col-12 col-md-6">
                        <div class=" p-3 h-100 bg-light">
                            <h6 class="fw-bold mb-3 text-dark border-bottom pb-2"> Votre adresse de livraison</h6>
                            <div class="text-muted small">
                                {{choices.addresses|raw}}
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-md-6">
                        <div class="p-3 h-100 bg-light">
                            <h6 class="fw-bold mb-3 text-dark border-bottom pb-2"> Votre transporteur</h6>
                            <div class="text-muted small">
                                {{choices.carriers|raw}}
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <div class="col-12 col-lg-4">
                <div class=" p-4 bg-white sticky-top" style="top: 2rem;">
                    
                    <h4 class="card-title fw-bold mb-4 text-dark border-bottom pb-2">Montant total</h4>

                    <div class="d-flex justify-content-between py-2">
                        <span class="text-muted">Total des produits ({{fullCartQuantity}} articles) :</span>
                        <span>{{totalWt|price}}</span>
                    </div>

                    <div class="d-flex justify-content-between py-2">
                        <span class="text-muted">Frais de livraison :</span>
                        <span>{{choices.carriers.price|price}}</span>
                    </div>
                    
                    <hr class="my-3">

                    <div class="d-flex justify-content-between pt-2">
                        <span class="fw-bolder fs-5 text-dark">Total Commande :</span>
                        <span class="fw-bolder fs-5 text-secondary">{{(totalWt + choices.carriers.price)|price}}</span>
                    </div>

                    <div class="mt-4">
                        <a href="{{path('app_payment',{order_id:order.id})}}" class="btn text-white bg-dark   btn-sm w-100  py-2 ">
                             Payer ma commande
                        </a>
                    </div>

                    <p class="small text-center  mt-3 mb-0">
                        Transaction sécurisée par carte bancaire.
                    </p>
                </div>
            </div>

        </div>
    </div>
{% endblock %}